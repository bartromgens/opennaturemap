<aside class="sidebar" [class.sidebar--expanded]="expanded()">
  <div class="sidebar__inner">
    @if (expanded()) {
      <header class="sidebar__header">
        <h2 class="sidebar__title">Reserve details</h2>
        <button mat-icon-button (click)="onClose()" aria-label="Close sidebar">
          <mat-icon>close</mat-icon>
        </button>
      </header>
      @if (error()) {
        <p class="sidebar__error">{{ error() }}</p>
      } @else if (reserve()) {
        <div class="sidebar__content">
          <h3 class="reserve-name">
            @if (wikipediaUrl(reserve()!); as url) {
              <a
                [href]="url"
                target="_blank"
                rel="noopener noreferrer"
                class="reserve-name__link"
                >{{ reserve()!.name || 'Unnamed reserve' }}</a
              >
            } @else {
              {{ reserve()!.name || 'Unnamed reserve' }}
            }
          </h3>
          @if (protectionBadgeText(reserve()!); as badgeText) {
            <mat-chip-set>
              <mat-chip
                [class]="protectionBadgeClass(reserve()!)"
                [attr.title]="
                  'Protection class: ' + (reserve()!.protect_class ?? '') + ' â€“ learn more'
                "
                (click)="navigateToProtectionClasses()"
                class="protection-badge-link"
                >{{ badgeText }}</mat-chip
              >
            </mat-chip-set>
          }
          <dl class="reserve-details">
            @if (websiteUrl(reserve()!); as url) {
              <dt>Website</dt>
              <dd>
                <a
                  [href]="url"
                  target="_blank"
                  rel="noopener noreferrer"
                  class="reserve-details__link"
                  >{{ websiteDisplayUrl(url) }}</a
                >
              </dd>
            }
            @if (reserve()!.operators.length) {
              <dt>Operators</dt>
              <dd>
                <mat-chip-set>
                  @for (op of reserve()!.operators; track op.id) {
                    <mat-chip>{{ op.name }}</mat-chip>
                  }
                </mat-chip-set>
              </dd>
            }
            @if (reserve()!.tags && objectKeys(reserve()!.tags).length) {
              <dt>Tags</dt>
              <dd>
                <ul class="tag-list">
                  @for (key of objectKeys(reserve()!.tags); track key) {
                    <li>
                      <strong>{{ key }}</strong
                      >: {{ reserve()!.tags[key] }}
                    </li>
                  }
                </ul>
              </dd>
            }
          </dl>
        </div>
      }
    }
  </div>
</aside>
